(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1173],{57595:function(e,r,n){"use strict";var i=n(90849),t=n(34896),s=n(24246);function o(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);r&&(i=i.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,i)}return n}r.Z=function(e){return(0,s.jsx)(t.rU,function(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?o(Object(n),!0).forEach((function(r){(0,i.Z)(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}({isExternal:!0,color:"complimentary.500"},e))}},51471:function(e,r,n){"use strict";n.d(r,{Z:function(){return x}});var i=n(34896),t=n(88038),s=n.n(t),o=n(86677),c=(n(27378),n(90768)),l=n(35100),a=n(64989),d=n(48114),u=n(51365),p=n(29549),h=n(60709),g=n(24246),f=function(){var e=(0,o.useRouter)();return(0,g.jsx)(i.xu,{bg:"gray.50",border:"1px solid",borderColor:"blue.400",borderRadius:"md",justifyContent:"space-between",p:5,mb:5,mt:5,children:(0,g.jsxs)(i.xu,{children:[(0,g.jsxs)(i.Kq,{direction:{base:"column",sm:"row"},justifyContent:"space-between",children:[(0,g.jsx)(i.xv,{fontWeight:"semibold",children:"Configure your storage and messaging provider"}),(0,g.jsx)(p.zx,{size:"sm",variant:"outline",onClick:function(){e.push(h.fz)},children:"Configure"})]}),(0,g.jsxs)(i.xv,{children:["Before Fides can process your privacy requests we need two simple steps to configure your storage and email client."," "]})]})})},x=function(e){var r=e.children,n=e.title,t=(0,c.hz)(),p=(0,o.useRouter)(),h="/privacy-requests"===p.pathname||"/datastore-connection"===p.pathname,x=!(t.flags.privacyRequestsConfiguration&&h),m=(0,u.JE)(void 0,{skip:x}).data,v=(0,u.PW)(void 0,{skip:x}).data,j=t.flags.privacyRequestsConfiguration&&(!m||!v)&&h;return(0,g.jsxs)(i.kC,{"data-testid":n,direction:"column",children:[(0,g.jsxs)(s(),{children:[(0,g.jsxs)("title",{children:["Fides Admin UI - ",n]}),(0,g.jsx)("meta",{name:"description",content:"Privacy Engineering Platform"}),(0,g.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,g.jsx)(l.Z,{}),(0,g.jsx)(d.Z,{}),(0,g.jsxs)(i.kC,{as:"main",flexGrow:1,padding:10,gap:10,children:[(0,g.jsx)(i.xu,{flex:0,flexShrink:0,children:(0,g.jsx)(a.U,{})}),(0,g.jsxs)(i.kC,{direction:"column",flex:1,minWidth:0,children:[j?(0,g.jsx)(f,{}):null,r]})]})]})}},65535:function(e,r,n){"use strict";n.d(r,{ZS:function(){return c},a4:function(){return s}});var i=n(80406),t=n(28703).u.injectEndpoints({endpoints:function(e){return{getPurposes:e.query({query:function(){return"purposes"}})}}}),s=t.useGetPurposesQuery,o={purposes:{},special_purposes:{}},c=(0,i.P1)(t.endpoints.getPurposes.select(),(function(e){return e.data||o}))},10471:function(e,r,n){"use strict";n.r(r);var i=n(90849),t=n(73679),s=n(55732),o=n(97865),c=n(34707),l=n.n(c),a=n(34896),d=n(70409),u=n(83125),p=n(62709),h=n(29549),g=n(34090),f=n(27378),x=n(6848),m=n(57595),v=n(90768),j=n(43139),b=n(78624),y=n(51471),C=n(65535),_=n(38687),O=n(24753),w=n(44047),k=n(51365),P=n(37968),S=n(24246);function E(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);r&&(i=i.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,i)}return n}function T(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?E(Object(n),!0).forEach((function(r){(0,i.Z)(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}var z=function(e){var r=e.children,n=e.purpose,i=e.endCol;return(0,S.jsx)(a.kC,{flex:"1",justifyContent:"center",alignItems:"center",borderLeft:"solid 1px",borderRight:i?"solid 1px":"unset",borderColor:"gray.200",height:"100%",minWidth:"36px",children:[1,3,4,5,6].includes(n)?null:(0,S.jsx)(a.xu,{children:r})})};r.default=function(){var e=(0,w.x8)().isLoading,r=(0,v.hz)().tcf,n=(0,w.n3)(void 0,{skip:e||!r}),i=n.data,c=n.isLoading,E=(0,w.M7)(),I=(0,o.Z)(E,2),W=I[0],Z=I[1].isLoading,D=(0,k.tB)({api_set:!0}),L=D.data,F=D.isLoading,R=(0,k.tB)({api_set:!1}),H=R.data,q=R.isLoading,N=(0,k.L)(),A=(0,o.Z)(N,2),$=A[0],B=A[1].isLoading,M=(0,f.useMemo)((function(){return L&&null!==L&&void 0!==L&&L.consent&&"override_vendor_purposes"in L.consent?L.consent.override_vendor_purposes:!!(H&&null!==H&&void 0!==H&&H.consent&&"override_vendor_purposes"in H.consent)&&H.consent.override_vendor_purposes}),[L,H]),V=(0,C.a4)().isLoading,G=(0,x.C)(C.ZS).purposes,U=(0,d.pm)(),X=function(){var e=(0,s.Z)(l().mark((function e(r,n){var i,s,o;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=function(e){if(U.closeAll(),(0,b.D4)(e)){var i=(0,b.e$)(e.error,"An unexpected error occurred while saving vendor overrides. Please try again.");U((0,O.Vo)(i))}else U((0,O.t5)("TCF Purpose Overrides saved successfully")),n.resetForm({values:r})},s=(0,t.Z)(r.purposeOverrides.map((function(e){var r;return e.is_consent&&(r=P.I$.CONSENT),e.is_legitimate_interest&&(r=P.I$.LEGITIMATE_INTERESTS),{purpose:e.purpose,is_included:e.is_included,required_legal_basis:r}}))),e.next=4,W(s);case 4:o=e.sent,i(o);case 6:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}(),J=function(){var e=(0,s.Z)(l().mark((function e(r){var n,t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=function(e){if(U.closeAll(),(0,b.D4)(e)){var r=(0,b.e$)(e.error,"An unexpected error occurred while saving vendor override settings. Please try again.");U((0,O.Vo)(r))}},e.next=3,$({consent:{override_vendor_purposes:r.target.checked}});case 3:if(t=e.sent,!r.target.checked){e.next=7;break}return e.next=7,W(i.map((function(e){return T(T({},e),{},{is_included:!0,required_legal_basis:void 0})})));case 7:n(t);case 8:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),K=(0,f.useMemo)((function(){return{purposeOverrides:i?i.map((function(e){return{purpose:e.purpose,is_included:e.is_included,is_consent:e.required_legal_basis===P.I$.CONSENT,is_legitimate_interest:e.required_legal_basis===P.I$.LEGITIMATE_INTERESTS}})):[]}}),[i]);return(0,S.jsx)(y.Z,{title:"Consent Configuration",children:e||V||c||F||q?(0,S.jsx)(a.kC,{justifyContent:"center",alignItems:"center",height:"100%",children:(0,S.jsx)(u.$,{})}):(0,S.jsxs)(a.xu,{"data-testid":"consent-configuration",children:[(0,S.jsx)(a.X6,{marginBottom:4,fontSize:"2xl",children:"Consent settings"}),(0,S.jsxs)(a.xu,{children:[(0,S.jsxs)(a.xu,{backgroundColor:"gray.50",borderRadius:"4px",padding:"14px",children:[(0,S.jsx)(a.xv,{fontSize:"md",fontWeight:"bold",lineHeight:5,color:"gray.700",children:"Transparency & Consent Framework settings"}),(0,S.jsxs)(a.xv,{mb:2,mt:3,fontSize:"sm",lineHeight:"5",fontWeight:"medium",color:"gray.700",children:["TCF status"," ",r?(0,S.jsx)(a.Ct,{backgroundColor:"green.100",children:"Enabled "}):(0,S.jsx)(a.Ct,{backgroundColor:"red.100",children:"Disabled"})]}),(0,S.jsxs)(a.xv,{fontSize:"sm",lineHeight:"5",fontWeight:"medium",color:"gray.700",children:["To ",r?"disable":"enable"," TCF, please contact your Fides administrator or"," ",(0,S.jsx)(m.Z,{href:"mailto:support@ethyca.com",children:"Ethyca support"}),"."]})]}),(0,S.jsxs)(a.xu,{mt:"24px",backgroundColor:"gray.50",borderRadius:"4px",padding:"14px",children:[(0,S.jsx)(a.xv,{fontSize:"md",fontWeight:"bold",lineHeight:5,color:"gray.700",mb:3,children:"Vendor overrides"}),r?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(a.xv,{mb:2,fontSize:"sm",lineHeight:"5",fontWeight:"medium",color:"gray.700",children:"Configure overrides for TCF related purposes."}),(0,S.jsxs)(a.kC,{alignItems:"center",marginBottom:2,children:[(0,S.jsx)(p.r,{size:"sm",colorScheme:"purple",isChecked:M,onChange:J,isDisabled:B}),(0,S.jsx)(a.xv,{px:2,fontSize:"sm",lineHeight:"5",fontWeight:"medium",color:"gray.700",children:"Override vendor purposes"}),(0,S.jsx)(_.Z,{label:"Toggle on if you want to globally change any flexible legal bases or remove TCF purposes from your CMP"})]}),(0,S.jsx)(a.xv,{mb:2,fontSize:"sm",lineHeight:"5",fontWeight:"medium",color:"gray.700",children:M?"The table below allows you to adjust which TCF purposes you allow as part of your user facing notices and business activites.":null})]}):null,M&&r?(0,S.jsxs)(a.xv,{fontSize:"sm",lineHeight:"5",fontWeight:"medium",color:"gray.700",children:["To configure this section, select the purposes you allow and where available, the appropriate legal bases (either Consent or Legitimate Interest)."," ",(0,S.jsxs)(m.Z,{href:"https://fid.es/tcf-overrides",children:["Read the guide on vendor overrides here."," "]})]}):null]})]}),M?(0,S.jsx)(a.xu,{mt:4,children:(0,S.jsx)(g.J9,{initialValues:K,enableReinitialize:!0,onSubmit:X,children:function(e){var r=e.values,n=e.dirty,i=e.isValid,t=e.setFieldValue;return(0,S.jsxs)(g.l0,{children:[(0,S.jsx)(g.F2,{name:"purposeOverrides",render:function(){return(0,S.jsxs)(a.kC,{flexDirection:"column",minWidth:"944px",children:[(0,S.jsxs)(a.kC,{width:"100%",border:"solid 1px",borderColor:"gray.200",backgroundColor:"gray.50",height:"36px",children:[(0,S.jsx)(a.kC,{width:"600px",pl:"4",fontSize:"xs",fontWeight:"medium",lineHeight:"4",alignItems:"center",borderRight:"solid 1px",borderColor:"gray.200",children:"TCF purpose"}),(0,S.jsx)(a.kC,{flex:"1",alignItems:"center",borderRight:"solid 1px",borderColor:"gray.200",minWidth:"36px",children:(0,S.jsx)(a.xv,{pl:"4",fontSize:"xs",fontWeight:"medium",lineHeight:"4",children:"Allowed"})}),(0,S.jsx)(a.kC,{flex:"1",alignItems:"center",borderRight:"solid 1px",borderColor:"gray.200",children:(0,S.jsx)(a.xv,{pl:"4",fontSize:"xs",fontWeight:"medium",lineHeight:"4",children:"Consent"})}),(0,S.jsx)(a.kC,{flex:"1",alignItems:"center",children:(0,S.jsx)(a.xv,{pl:"4",fontSize:"xs",fontWeight:"medium",lineHeight:"4",children:"Legitimate interest"})})]}),r.purposeOverrides.map((function(e,n){return(0,S.jsxs)(a.kC,{width:"100%",height:"36px",alignItems:"center",borderBottom:"solid 1px",borderColor:"gray.200",children:[(0,S.jsxs)(a.kC,{width:"600px",borderLeft:"solid 1px",borderColor:"gray.200",p:0,alignItems:"center",height:"100%",pl:"4",fontSize:"xs",fontWeight:"normal",lineHeight:"4",children:["Purpose ",e.purpose,":"," ",G[e.purpose].name]}),(0,S.jsx)(a.kC,{flex:"1",justifyContent:"center",alignItems:"center",borderLeft:"solid 1px",borderColor:"gray.200",height:"100%",children:(0,S.jsx)(a.xu,{children:(0,S.jsx)(j.w8,{name:"purposeOverrides[".concat(n,"].is_included"),onChange:function(e){e.target.checked||(t("purposeOverrides[".concat(n,"].is_consent"),!1),t("purposeOverrides[".concat(n,"].is_legitimate_interest"),!1))}})})}),(0,S.jsx)(z,{purpose:e.purpose,children:(0,S.jsx)(j.w8,{isDisabled:!r.purposeOverrides[n].is_included||r.purposeOverrides[n].is_legitimate_interest,name:"purposeOverrides[".concat(n,"].is_consent")})}),(0,S.jsx)(z,{purpose:e.purpose,endCol:!0,children:(0,S.jsx)(j.w8,{isDisabled:!r.purposeOverrides[n].is_included||r.purposeOverrides[n].is_consent,name:"purposeOverrides[".concat(n,"].is_legitimate_interest")})})]},e.purpose)}))]})}}),(0,S.jsx)(a.xu,{mt:6,children:(0,S.jsx)(h.zx,{type:"submit",variant:"primary",size:"sm",isDisabled:Z||!n||!i,isLoading:Z,"data-testid":"save-btn",children:"Save"})})]})}})}):null]})})}},67739:function(e,r,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/management/consent",function(){return n(10471)}])}},function(e){e.O(0,[2141,845,331,3139,9774,2888,179],(function(){return r=67739,e(e.s=r);var r}));var r=e.O();_N_E=r}]);