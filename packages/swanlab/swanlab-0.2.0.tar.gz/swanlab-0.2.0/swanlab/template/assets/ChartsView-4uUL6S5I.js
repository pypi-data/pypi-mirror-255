import{u as e,J as a,K as s,o as t,a as r,q as n,g as l,F as o,h as c,k as i,b as u,t as h,d as m,n as p,i as d}from"./index-KILuQHLl.js";import{C as f}from"./ChartsContainer-iMbgOMcE.js";import"./SLLoading-rZ7HTbJF.js";const g={__name:"ChartsPage",props:{groups:{type:Array,required:!0},charts:{type:Array,required:!0}},setup(i){const u=i,h=e(),m=new Map;a((()=>{m.forEach((e=>{clearInterval(e)}))})),s("$on",((e,a,s)=>{e.map((e=>{if(0===h.experiments.find((a=>a.name===e)).show)return s(e,null,null);p(e,a,s),0===h.experiments.find((a=>a.name===e)).status&&((e,a,s)=>{const t=setInterval((()=>{p(e,a,s)}),5e3);m.set(e+"-"+a,t)})(e,a,s)}))})),s("$off",(()=>{}));const p=(e,a,s)=>{const t=h.experiments.find((a=>a.name===e)).id,r=u.charts.find((e=>e.id===a)).name;c.get(`/experiment/${t}/tag/${r}`).then((a=>{s(e,a.data,null)})).catch((()=>{s(e,null,null)}))};return(e,a)=>(t(!0),r(o,null,n(i.groups,(e=>(t(),l(f,{key:e.name,label:e.name,charts:e.charts},null,8,["label","charts"])))),128))}},v={class:"flex flex-col min-h-full bg-higher"},x={class:"flex items-center gap-3"},y={class:"text-2xl items-center gap-1 font-semibold max-w-md truncate"},C={key:1,class:"font-semibold mt-5 text-center"},w={__name:"ChartsView",setup(n){const o=e();c.get("/project/charts").then((({data:e})=>{b.value=e.charts,k.value=e.namespaces,w.value=j()}));const f=d("isSideBarShow"),w=i([]),b=i([]),k=i([]),S=i(0),j=()=>{const e=[];return k.value.forEach((a=>{const s={name:a.name,charts:[]};a.charts.forEach((e=>{const a=b.value.find((a=>a.id===e));if(a.source.every((e=>!o.showMap[e])))return;a.source.filter((e=>!a.error[e])).every((e=>!o.showMap[e]))||s.charts.push(a)})),s.charts.length&&e.push(s)})),e};o.registerChangeShowCallback((()=>{S.value++,w.value=j()})),a((()=>{o.destoryChangeShowCallback()}));const E=[...o.colors];return E.getSeriesColor=(()=>{const e=o.colorMap;return a=>e[a]})(),s("colors",E),(e,a)=>(t(),r("div",v,[u("div",{class:p(["project-title transition-marging duration-300 mt-5 pl-6",{"ml-8":!m(f)}])},[u("div",x,[u("h1",y,h(m(o).name),1)])],2),w.value.length?(t(),l(g,{groups:w.value,charts:b.value,key:S.value},null,8,["groups","charts"])):(t(),r("p",C,"Empty Charts"))]))}};export{w as default};
