var E=Object.defineProperty;var m=(t,e,r)=>e in t?E(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var d=(t,e,r)=>(m(t,typeof e!="symbol"?e+"":e,r),r);import{a as b}from"./index.8c002fdd.js";class C extends Error{constructor(r,n,s){super(s);d(this,"url");d(this,"status");d(this,"statusText");d(this,"body");d(this,"request");this.name="ApiError",this.url=n.url,this.status=n.status,this.statusText=n.statusText,this.body=n.body,this.request=r}}class w extends Error{constructor(e){super(e),this.name="CancelError"}get isCancelled(){return!0}}var U;class S{constructor(e){d(this,U);d(this,"_isResolved");d(this,"_isRejected");d(this,"_isCancelled");d(this,"_cancelHandlers");d(this,"_promise");d(this,"_resolve");d(this,"_reject");this._isResolved=!1,this._isRejected=!1,this._isCancelled=!1,this._cancelHandlers=[],this._promise=new Promise((r,n)=>{this._resolve=r,this._reject=n;const s=o=>{var a;this._isResolved||this._isRejected||this._isCancelled||(this._isResolved=!0,(a=this._resolve)==null||a.call(this,o))},c=o=>{var a;this._isResolved||this._isRejected||this._isCancelled||(this._isRejected=!0,(a=this._reject)==null||a.call(this,o))},i=o=>{this._isResolved||this._isRejected||this._isCancelled||this._cancelHandlers.push(o)};return Object.defineProperty(i,"isResolved",{get:()=>this._isResolved}),Object.defineProperty(i,"isRejected",{get:()=>this._isRejected}),Object.defineProperty(i,"isCancelled",{get:()=>this._isCancelled}),e(s,c,i)})}then(e,r){return this._promise.then(e,r)}catch(e){return this._promise.catch(e)}finally(e){return this._promise.finally(e)}cancel(){var e;if(!(this._isResolved||this._isRejected||this._isCancelled)){if(this._isCancelled=!0,this._cancelHandlers.length)try{for(const r of this._cancelHandlers)r()}catch(r){console.warn("Cancellation threw an error",r);return}this._cancelHandlers.length=0,(e=this._reject)==null||e.call(this,new w("Request aborted"))}}get isCancelled(){return this._isCancelled}}U=Symbol.toStringTag;var j=typeof self=="object"?self.FormData:window.FormData;const p=t=>t!=null,y=t=>typeof t=="string",_=t=>y(t)&&t!=="",g=t=>typeof t=="object"&&typeof t.type=="string"&&typeof t.stream=="function"&&typeof t.arrayBuffer=="function"&&typeof t.constructor=="function"&&typeof t.constructor.name=="string"&&/^(Blob|File)$/.test(t.constructor.name)&&/^(Blob|File)$/.test(t[Symbol.toStringTag]),T=t=>t instanceof j,A=t=>t>=200&&t<300,H=t=>{try{return btoa(t)}catch{return Buffer.from(t).toString("base64")}},$=t=>{const e=[],r=(s,c)=>{e.push(`${encodeURIComponent(s)}=${encodeURIComponent(String(c))}`)},n=(s,c)=>{p(c)&&(Array.isArray(c)?c.forEach(i=>{n(s,i)}):typeof c=="object"?Object.entries(c).forEach(([i,o])=>{n(`${s}[${i}]`,o)}):r(s,c))};return Object.entries(t).forEach(([s,c])=>{n(s,c)}),e.length>0?`?${e.join("&")}`:""},q=(t,e)=>{const r=t.ENCODE_PATH||encodeURI,n=e.url.replace("{api-version}",t.VERSION).replace(/{(.*?)}/g,(c,i)=>{var o;return(o=e.path)!=null&&o.hasOwnProperty(i)?r(String(e.path[i])):c}),s=`${t.BASE}${n}`;return e.query?`${s}${$(e.query)}`:s},B=t=>{if(t.formData){const e=new j,r=(n,s)=>{y(s)||g(s)?e.append(n,s):e.append(n,JSON.stringify(s))};return Object.entries(t.formData).filter(([n,s])=>p(s)).forEach(([n,s])=>{Array.isArray(s)?s.forEach(c=>r(n,c)):r(n,s)}),e}},f=async(t,e)=>typeof e=="function"?e(t):e,O=async(t,e,r)=>{const n=await f(e,t.TOKEN),s=await f(e,t.USERNAME),c=await f(e,t.PASSWORD),i=await f(e,t.HEADERS),o=typeof(r==null?void 0:r.getHeaders)=="function"&&(r==null?void 0:r.getHeaders())||{},a=Object.entries({Accept:"application/json",...i,...e.headers,...o}).filter(([l,h])=>p(h)).reduce((l,[h,u])=>({...l,[h]:String(u)}),{});if(_(n)&&(a.Authorization=`Bearer ${n}`),_(s)&&_(c)){const l=H(`${s}:${c}`);a.Authorization=`Basic ${l}`}return e.body&&(e.mediaType?a["Content-Type"]=e.mediaType:g(e.body)?a["Content-Type"]=e.body.type||"application/octet-stream":y(e.body)?a["Content-Type"]="text/plain":T(e.body)||(a["Content-Type"]="application/json")),a},x=t=>{if(t.body)return t.body},F=async(t,e,r,n,s,c,i)=>{const o=b.CancelToken.source(),a={url:r,headers:c,data:n!=null?n:s,method:e.method,withCredentials:t.WITH_CREDENTIALS,cancelToken:o.token};i(()=>o.cancel("The user aborted a request."));try{return await b.request(a)}catch(l){const h=l;if(h.response)return h.response;throw l}},P=(t,e)=>{if(e){const r=t.headers[e];if(y(r))return r}},I=t=>{if(t.status!==204)return t.data},N=(t,e)=>{const n={400:"Bad Request",401:"Unauthorized",403:"Forbidden",404:"Not Found",500:"Internal Server Error",502:"Bad Gateway",503:"Service Unavailable",...t.errors}[e.status];if(n)throw new C(t,e,n);if(!e.ok)throw new C(t,e,"Generic Error")},z=(t,e)=>new S(async(r,n,s)=>{try{const c=q(t,e),i=B(e),o=x(e),a=await O(t,e,i);if(!s.isCancelled){const l=await F(t,e,c,o,i,a,s),h=I(l),u=P(l,e.responseHeader),R={url:c,ok:A(l.status),status:l.status,statusText:l.statusText,body:u!=null?u:h};N(e,R),r(R.body)}}catch(c){n(c)}});export{z as r};
