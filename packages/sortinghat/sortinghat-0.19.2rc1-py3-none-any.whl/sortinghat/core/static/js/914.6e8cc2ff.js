"use strict";(self["webpackChunksortinghat_ui"]=self["webpackChunksortinghat_ui"]||[]).push([[914],{914:(e,t,n)=>{n.r(t),n.d(t,{default:()=>_e});var a=n(4437),r=n(9953),i=n(5294),o=n(4590),s=function(){var e=this,t=e._self._c;return t(r.Z,[t("work-space",{staticClass:"ma-md-8 mt-md-6",attrs:{enroll:e.enroll,"highlight-individual":e.highlightInWorkspace,individuals:e.savedIndividuals,"merge-items":e.mergeItems,"move-item":e.moveItem},on:{clearSpace:e.clearWorkspace,updateIndividuals:e.updateTable,highlight:function(t){return e.highlightIndividual(t,"highlightInTable",!0)},stopHighlight:function(t){return e.highlightIndividual(t,"highlightInTable",!1)},deselect:e.deselectIndividuals,updateOrganizations:e.updateOrganizations,updateWorkspace:e.updateWorkspace,updateStore:function(t){return e.saveWorkspace(t)}}}),t(i.Z,[t(a.Z,{staticClass:"pa-0 mr-lg-8",attrs:{lg:"8",sm:"12"}},[t("individuals-table",{ref:"table",staticClass:"individuals",attrs:{"is-expandable":"",outlined:"","fetch-page":e.getIndividualsPage,"delete-item":e.deleteItem,"merge-items":e.mergeItems,"unmerge-items":e.unmergeItems,"move-item":e.moveItem,"highlight-individual":e.highlightInTable,"add-identity":e.addIdentity,updateProfile:e.updateProfile,enroll:e.enroll,"fetch-organizations":e.getOrganizationsPage,"get-countries":e.getCountries,"lock-individual":e.lockIndividual,"set-filters":e.filters,"unlock-individual":e.unlockIndividual,withdraw:e.withdraw,"update-enrollment":e.updateEnrollment,"recommend-matches":e.recommendMatches},on:{saveIndividuals:e.addSavedIndividuals,setFilters:function(t){e.filters=t},updateOrganizations:e.updateOrganizations,updateWorkspace:e.updateWorkspace,highlight:function(t){return e.highlightIndividual(t,"highlightInWorkspace",!0)},stopHighlight:function(t){return e.highlightIndividual(t,"highlightInWorkspace",!1)}}})],1),t(a.Z,{staticClass:"pa-0 organizations mt-8 mt-lg-0"},[t("organizations-table",{ref:"organizations",attrs:{"fetch-page":e.getOrganizationsPage,enroll:e.enroll,"add-organization":e.addOrganization,"add-domain":e.addDomain,"delete-domain":e.deleteDomain,"delete-organization":e.deleteOrganization,"add-team":e.addTeam,"delete-team":e.deleteTeam,"fetch-teams":e.fetchTeams,"merge-items":e.mergeOrgs},on:{getEnrollments:e.getEnrollments,updateIndividuals:e.updateTable,updateWorkspace:e.updateWorkspace}})],1)],1),t(o.Z,{model:{value:e.snackbar,callback:function(t){e.snackbar=t},expression:"snackbar"}},[e._v(" Individual already in work space ")])],1)},l=[],u=n(1907),c=n(5617),d=n(6080),m=(n(9554),n(1539),n(4747),n(9826),n(4553),n(7658),n(7941),n(561),n(2222),n(8783),n(3948),n(1249),n(5246)),p=n(680),g=n(6136),f=n(5129),v=n(3385),h=n(5223),Z=n(2082),x=n(2992),k=n(8560),b=n(6121),w=n(2327),I=n(5093),T=n(5234),_=n(3606),y=(n(8309),function(){var e=this,t=e._self._c;return t("section",{staticClass:"section"},[t(i.Z,{staticClass:"header"},[t("h4",{staticClass:"title"},[t(w.Z,{attrs:{color:"black",left:"",dense:""}},[e._v(" "+e._s(e.isGroup?"mdi-account-group":"mdi-sitemap")+" ")]),e._v(" "+e._s(e.name)+" "),t(Z.Z,{staticClass:"ml-2",attrs:{pill:"",small:""}},[e._v(e._s(e.totalResults))])],1),e.isGroup?t(b.Z,{attrs:{large:""},on:{save:e.addUnaffiliatedTeam,cancel:function(t){e.forms.teamName=""}},scopedSlots:e._u([{key:"input",fn:function(){return[t(_.Z,{attrs:{label:"Team name",maxlength:"50","single-line":""},model:{value:e.forms.teamName,callback:function(t){e.$set(e.forms,"teamName",t)},expression:"forms.teamName"}})]},proxy:!0}],null,!1,719405850)},[t(f.Z,{staticClass:"black--text",attrs:{depressed:"",small:"",height:"34",color:"secondary"}},[e._v(" Add ")])],1):t(f.Z,{staticClass:"black--text",attrs:{depressed:"",small:"",height:"34",color:"secondary"},on:{click:function(t){return t.stopPropagation(),e.openModal.apply(null,arguments)}}},[e._v(" Add ")])],1),t(i.Z,{staticClass:"actions"},[t("search",{staticClass:"mr-3 pa-0 flex-grow-0",attrs:{"valid-filters":[]},on:{search:e.filterSearch}})],1),t(x.Z,{attrs:{"hide-default-header":"","hide-default-footer":"",headers:e.headers,items:e.items,"items-per-page":e.itemsPerPage,expanded:e.expandedItems,"item-key":"id",page:e.page,loading:e.loading},on:{"update:expanded":function(t){e.expandedItems=t},"update:page":function(t){e.page=t}},scopedSlots:e._u([{key:"item",fn:function(n){var a=n.item,r=n.expand,i=n.isExpanded;return[t("organization-entry",{attrs:{name:a.name,enrollments:e.getEnrolledIndividuals(a.enrollments),"is-expanded":i,"is-editable":!e.isGroup,draggable:""},on:{expand:function(e){return r(!i)},enroll:e.confirmEnroll,edit:function(t){return e.openModal(a)},delete:function(t){return e.confirmDelete(a.name)},getEnrollments:function(t){return e.$emit("getEnrollments",{enrollment:a.name})},addTeam:function(t){return e.createTeam(a.name,t)},"merge:orgs":e.confirmMerge},nativeOn:{dblclick:function(e){return r(!i)},dragstart:function(t){return e.startDrag(a,t)}}})]}},{key:"expanded-item",fn:function(n){var a=n.item;return[t("expanded-organization",{ref:a.id,attrs:{organization:a.name,"is-group":e.isGroup,domains:a.domains,"add-team":e.addTeam,"delete-team":e.deleteTeam,"fetch-teams":e.fetchTeams},on:{enroll:e.confirmEnroll,getEnrollments:function(t){return e.$emit("getEnrollments",t)}}})]}}])}),t("div",{staticClass:"pagination text-center pa-3"},[t("div",{attrs:{"aria-hidden":"true"}}),t(I.Z,{attrs:{length:e.pageCount,"total-visible":5},on:{input:function(t){return e.getTableItems(t)}},model:{value:e.page,callback:function(t){e.page=t},expression:"page"}}),t(_.Z,{staticClass:"mr-3",attrs:{value:e.itemsPerPage,label:"Items per page",type:"number",min:"1",max:e.totalResults,"hide-details":""},on:{change:function(t){return e.changeItemsPerPage(t)}}})],1),e.isGroup?e._e():t("organization-modal",{attrs:{"is-open":e.modal.open,"add-organization":e.addOrganization,"add-domain":e.addDomain,"delete-domain":e.deleteDomain,organization:e.modal.organization,domains:e.modal.domains},on:{"update:isOpen":function(t){return e.$set(e.modal,"open",t)},"update:is-open":function(t){return e.$set(e.modal,"open",t)},updateOrganizations:function(t){return e.getTableItems(e.page)}}}),t(k.Z,{attrs:{"max-width":"500px"},model:{value:e.dialog.open,callback:function(t){e.$set(e.dialog,"open",t)},expression:"dialog.open"}},[t(v.Z,{staticClass:"pa-3"},[t(h.EB,{staticClass:"headline"},[e._v(e._s(e.dialog.title))]),t(h.ZB,[t("p",{staticClass:"pt-2 pb-2 text-body-2"},[e._v(e._s(e.dialog.text))]),e.dialog.showDates?t("div",[t("h6",{staticClass:"subheader"},[e._v("Enrollment dates (optional)")]),t(i.Z,[t(a.Z,{attrs:{cols:"6"}},[t("date-input",{attrs:{label:"Date from",outlined:""},model:{value:e.dialog.dateFrom,callback:function(t){e.$set(e.dialog,"dateFrom",t)},expression:"dialog.dateFrom"}})],1),t(a.Z,{attrs:{cols:"6"}},[t("date-input",{attrs:{label:"Date to",outlined:""},model:{value:e.dialog.dateTo,callback:function(t){e.$set(e.dialog,"dateTo",t)},expression:"dialog.dateTo"}})],1)],1)],1):e._e()]),e.dialog.action?t(h.h7,[t(T.Z),t(f.Z,{attrs:{text:""},on:{click:e.closeDialog}},[e._v(" Cancel ")]),t(f.Z,{attrs:{color:"primary",depressed:""},on:{click:function(t){return t.stopPropagation(),e.dialog.action.apply(null,arguments)}}},[e._v(" Confirm ")])],1):t(h.h7,[t(T.Z),t(f.Z,{attrs:{text:"",color:"primary"},on:{click:e.closeDialog}},[e._v(" OK ")])],1)],1)],1)],1)}),D=[],$=(n(7327),n(5212),n(1058),n(189),n(2729)),O=n(2067),z=n(5830),C=n(4284),E=n(2269),M=n(5265),S=n(3633),P=function(){var e=this,t=e._self._c;return t("td",{staticClass:"pa-2",attrs:{colspan:"3"}},[t(S.Z,{attrs:{items:e.teams,"load-children":e.loadChildren,open:e.openTeams,"expand-icon":"mdi-chevron-down",dense:"","open-on-click":"","return-object":""},on:{"update:open":function(t){e.openTeams=t}},scopedSlots:e._u([{key:"label",fn:function(n){var r=n.item;return[t(i.Z,{staticClass:"align-center",attrs:{draggable:"true"},on:{dragstart:function(t){return e.startDrag(e.organization,r,t)},drop:function(t){return t.stopPropagation(),e.onDrop(t,r)},dragover:function(t){return t.preventDefault(),e.isDropZone(t,!0)},dragenter:function(t){return t.preventDefault(),e.isDropZone(t,!0)},dragleave:function(t){return t.preventDefault(),e.isDropZone(t,!1)}}},[t(a.Z,[t("span",{staticClass:"font-weight-medium"},[e._v(e._s(r.name))])]),t(a.Z,{staticClass:"d-flex justify-end mr-7"},[t(f.Z,{attrs:{small:"",depressed:"",color:"transparent"},on:{click:function(t){return t.stopPropagation(),e.$emit("getEnrollments",{enrollment:r.name,parentOrg:e.organization})}}},[e._v(" "+e._s(r.enrollments)+" "),t(w.Z,{attrs:{small:"",right:""}},[e._v(" mdi-account-multiple ")])],1)],1)],1)]}},{key:"append",fn:function(n){var a=n.item;return[t(M.Z,{attrs:{left:"","nudge-left":"16"},scopedSlots:e._u([{key:"activator",fn:function(n){var a=n.on,r=n.attrs;return[t(f.Z,e._g(e._b({staticClass:"mr-9",attrs:{icon:"",small:""}},"v-btn",r,!1),a),[t(w.Z,{attrs:{small:""}},[e._v("mdi-dots-vertical")])],1)]}}],null,!0)},[t(z.Z,{attrs:{dense:""}},[t(b.Z,{attrs:{large:""},on:{save:function(t){return e.createTeam(a)},cancel:function(t){e.newTeam=""}},scopedSlots:e._u([{key:"input",fn:function(){return[t("h6",{staticClass:"text-subtitle-2 mt-2"},[e._v(" Add team to "+e._s(a.name)+" ")]),t(_.Z,{attrs:{label:"Name",maxlength:"50","single-line":""},model:{value:e.newTeam,callback:function(t){e.newTeam=t},expression:"newTeam"}})]},proxy:!0}],null,!0)},[t(C.Z,[t(E.V9,[e._v("Add a team")])],1)],1),t(C.Z,{on:{click:function(t){return e.confirmDelete(a)}}},[t(E.V9,[e._v("Delete team")])],1)],1)],1)]}}])}),0===e.teams.length?t("p",{staticClass:"ma-3 text--secondary ml-9"},[e._v("No teams")]):e._e(),e.dialog.isOpen?t(k.Z,{attrs:{"max-width":"500px"},model:{value:e.dialog.isOpen,callback:function(t){e.$set(e.dialog,"isOpen",t)},expression:"dialog.isOpen"}},[t(v.Z,{staticClass:"pa-3"},[t(h.EB,{staticClass:"headline"},[e._v(e._s(e.dialog.title))]),t(h.ZB,[t("p",{staticClass:"pt-2 pb-2 text-body-2"},[e._v(e._s(e.dialog.text))])]),e.dialog.action?t(h.h7,[t(T.Z),t(f.Z,{attrs:{text:""},on:{click:e.closeDialog}},[e._v(" Cancel ")]),t(f.Z,{attrs:{color:"primary",depressed:""},on:{click:function(t){return t.stopPropagation(),e.dialog.action.apply(null,arguments)}}},[e._v(" Confirm ")])],1):t(h.h7,[t(T.Z),t(f.Z,{attrs:{text:"",color:"primary"},on:{click:e.closeDialog}},[e._v(" OK ")])],1)],1)],1):e._e()],1)},q=[];n(6541),n(6699),n(2023);const F={name:"ExpandedOrganization",props:{domains:{type:Array,required:!1},organization:{type:String,required:!0},addTeam:{type:Function,required:!0},deleteTeam:{type:Function,required:!0},fetchTeams:{type:Function,required:!0},isGroup:{type:Boolean,required:!1,default:!1}},data:function(){return{teams:[],openTeams:[],newTeam:"",dialog:{isOpen:!1,title:""}}},methods:{getTeams:function(e){var t=this;return(0,c.Z)((0,u.Z)().mark((function n(){var a,r;return(0,u.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.fetchTeams({organization:t.organization,parent:e});case 2:return a=n.sent,r=a.data.teams.entities.map((function(e){return{name:e.name,enrollments:t.getEnrolledIndividuals(e.enrollments),children:e.numchild>0?[]:void 0}})),n.abrupt("return",r);case 5:case"end":return n.stop()}}),n)})))()},getEnrolledIndividuals:function(e){if(!e)return 0;var t=new Set(e.map((function(e){return e.id})));return t.size},loadChildren:function(e){var t=this;return(0,c.Z)((0,u.Z)().mark((function n(){return(0,u.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.getTeams(e.name);case 2:e.children=n.sent;case 3:case"end":return n.stop()}}),n)})))()},reloadTeams:function(){var e=this;return(0,c.Z)((0,u.Z)().mark((function t(){var n;return(0,u.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.openTeams,t.next=3,e.getTeams();case 3:e.teams=t.sent,n.forEach((function(t){var n=e.teams.find((function(e){return e.name===t.name}));n&&e.loadChildren(n)}));case 5:case"end":return t.stop()}}),t)})))()},startDrag:function(e,t,n){n.dataTransfer.dropEffect="move",n.dataTransfer.setData("group",t.name),n.dataTransfer.setData("parentorg",e)},createTeam:function(e){var t=this;return(0,c.Z)((0,u.Z)().mark((function n(){var a;return(0,u.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,t.addTeam(t.newTeam,t.organization,e.name);case 3:a=n.sent,a.errors||(e.children=e.children||[],e.children.push({name:t.newTeam,enrollments:0,children:void 0}),t.newTeam=""),n.next=11;break;case 7:n.prev=7,n.t0=n["catch"](0),Object.assign(t.dialog,{isOpen:!0,title:"Error",text:t.$getErrorMessage(n.t0),action:null}),t.$logger.error("Error creating team: ".concat(n.t0));case 11:case"end":return n.stop()}}),n,null,[[0,7]])})))()},removeTeam:function(e){var t=this;return(0,c.Z)((0,u.Z)().mark((function n(){var a;return(0,u.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,t.deleteTeam(e.name,t.organization);case 3:a=n.sent,a.errors||(t.$logger.debug("Deleted team ".concat(e.name)),t.removeTeamNode(e.name),t.closeDialog()),n.next=11;break;case 7:n.prev=7,n.t0=n["catch"](0),Object.assign(t.dialog,{title:"Error",text:t.$getErrorMessage(n.t0),action:null}),t.$logger.error("Error deleting team ".concat(e.name,": ").concat(n.t0));case 11:case"end":return n.stop()}}),n,null,[[0,7]])})))()},removeTeamNode:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.teams;n.every((function(a,r){return a.name===e?(n.splice(r,1),!1):(a.children&&t.removeTeamNode(e,a.children),!0)}))},confirmDelete:function(e){var t=this;Object.assign(this.dialog,{isOpen:!0,title:"Delete ".concat(e.name,"?"),action:function(){return t.removeTeam(e)}})},closeDialog:function(){Object.assign(this.dialog,{isOpen:!1,title:"",text:"",action:null})},isDropZone:function(e,t){var n=e.target.closest(".v-treeview-node__root"),a=e.dataTransfer.getData("type"),r=e.dataTransfer.types;t&&("individuals"===a||r.includes("individuals"))?n.classList.add("dropzone"):n.classList.remove("dropzone")},onDrop:function(e,t){var n=e.dataTransfer.types;if(e.target.closest(".v-treeview-node__root").classList.remove("dropzone"),n.includes("individuals")){var a=JSON.parse(e.dataTransfer.getData("individuals")).filter((function(e){return!e.isLocked}));a.length>0&&this.$emit("enroll",{individuals:a,parentOrg:this.organization,group:t.name})}}},created:function(){var e=this;return(0,c.Z)((0,u.Z)().mark((function t(){return(0,u.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getTeams();case 2:e.teams=t.sent;case 3:case"end":return t.stop()}}),t)})))()}},j=F;var W=n(1001),A=(0,W.Z)(j,P,q,!1,null,"20d657de",null);const B=A.exports;var N=n(8933),R=function(){var e=this,t=e._self._c;return t("tr",{class:{dropzone:e.dropZone},on:{drop:function(t){return t.stopPropagation(),e.onDrop(t)},dragover:function(t){return t.preventDefault(),e.isDropZone(t,!0)},dragenter:function(t){return t.preventDefault(),e.isDropZone(t,!0)},dragleave:function(t){return t.preventDefault(),e.isDropZone(t,!1)}}},[t("td",{staticClass:"font-weight-medium pl-8"},[t("router-link",{staticClass:"link--underline",attrs:{to:{name:"Organization",params:{name:encodeURIComponent(e.name)}},target:"_blank"}},[e._v(" "+e._s(e.name)+" ")])],1),t("td",{staticClass:"text-right text--secondary"},[t(N.Z,{attrs:{bottom:"",transition:"expand-y-transition","open-delay":"200"},scopedSlots:e._u([{key:"activator",fn:function(n){var a=n.on;return[t(f.Z,e._g({attrs:{depressed:"",color:"transparent"},on:{click:function(t){return t.stopPropagation(),e.$emit("getEnrollments")}}},a),[e._v(" "+e._s(e.enrollments)+" "),t(w.Z,{attrs:{small:"",right:""}},[e._v(" mdi-account-multiple ")])],1)]}}])},[t("span",[e._v("Enrollments")])])],1),t("td",{staticClass:"text-right"},[t(M.Z,{attrs:{left:"","nudge-left":"16"},scopedSlots:e._u([{key:"activator",fn:function(n){var a=n.on,r=n.attrs;return[t(f.Z,e._g(e._b({attrs:{icon:"",small:""}},"v-btn",r,!1),a),[t(w.Z,{attrs:{small:""}},[e._v("mdi-dots-vertical")])],1)]}}]),model:{value:e.showMenu,callback:function(t){e.showMenu=t},expression:"showMenu"}},[t(z.Z,{attrs:{dense:""}},[t(C.Z,{on:{click:function(t){return e.$emit("edit")}}},[t(E.V9,[e._v(" View/edit domains ")])],1),t(b.Z,{attrs:{large:""},on:{save:function(t){e.$emit("addTeam",e.newTeam),e.newTeam=""},cancel:function(t){e.newTeam=""}},scopedSlots:e._u([{key:"input",fn:function(){return[t("h6",{staticClass:"text-subtitle-2 mt-2"},[e._v("Add team to "+e._s(e.name))]),t(_.Z,{attrs:{label:"Name",maxlength:"50","single-line":""},model:{value:e.newTeam,callback:function(t){e.newTeam=t},expression:"newTeam"}})]},proxy:!0}])},[t(C.Z,{on:{click:function(t){e.showMenu=!1}}},[t(E.V9,[e._v("Add a team")])],1)],1),t(C.Z,{on:{click:function(t){return e.$emit("delete")}}},[t(E.V9,[e._v("Delete organization")])],1)],1)],1),t(f.Z,{attrs:{icon:""},on:{click:function(t){return t.stopPropagation(),e.$emit("expand")}}},[t(w.Z,[e._v(" "+e._s(e.isExpanded?"mdi-chevron-up":"mdi-chevron-down")+" ")])],1)],1)])},L=[];n(9653);const U={name:"OrganizationEntry",props:{name:{type:String,required:!0},enrollments:{type:Number,required:!0},isExpanded:{type:Boolean,required:!0},isEditable:{type:Boolean,required:!1,default:!0}},data:function(){return{dropZone:!1,showMenu:!1,newTeam:""}},methods:{onDrop:function(e){this.dropZone=!1;var t=e.dataTransfer.getData("group"),n=e.dataTransfer.types.includes("parentorg"),a=e.dataTransfer.getData("individuals");if(t&&t!==this.name&&!n)this.$emit("merge:orgs",{fromOrg:t,toOrg:this.name});else if(a){var r=JSON.parse(a).filter((function(e){return!e.isLocked}));r.length>0&&this.$emit("enroll",{individuals:r,group:this.name})}},isDropZone:function(e,t){var n=e.dataTransfer.types;this.dropZone=t&&!n.includes("lockactions")&&!n.includes("parentorg")}}},G=U;var H=(0,W.Z)(G,R,L,!1,null,"3e83552a",null);const V=H.exports;var K=n(457),J=n(5393),Y=function(){var e=this,t=e._self._c;return t(k.Z,{attrs:{persistent:"","max-width":"440px"},model:{value:e.isOpen,callback:function(t){e.isOpen=t},expression:"isOpen"}},[t(v.Z,{staticClass:"section"},[t(h.EB,{staticClass:"header"},[t("span",{staticClass:"title"},[e._v(" "+e._s(e.organization?"Edit":"Add")+" organization ")])]),t("form",[t(h.ZB,[t(i.Z,[t(a.Z,{attrs:{cols:"12"}},[t(_.Z,{attrs:{label:"Name",disabled:!!e.savedData.name,outlined:"",dense:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1),t(i.Z,{staticClass:"pl-4"},[t("span",{staticClass:"subheader"},[e._v("Domains")])]),e._l(e.form.domains,(function(n,r){return t(i.Z,{key:r,staticClass:"align-bottom"},[t(a.Z,{attrs:{cols:"6"}},[t(_.Z,{attrs:{label:"Domain","hide-details":"",outlined:"",dense:""},model:{value:e.form.domains[r].domain,callback:function(t){e.$set(e.form.domains[r],"domain",t)},expression:"form.domains[index].domain"}})],1),t(a.Z,{attrs:{cols:"4"}},[t(J.Z,{attrs:{label:"Top domain",dense:"","hide-details":""},model:{value:e.form.domains[r].isTopDomain,callback:function(t){e.$set(e.form.domains[r],"isTopDomain",t)},expression:"form.domains[index].isTopDomain"}})],1),t(a.Z,{staticClass:"pt-3",attrs:{cols:"2"}},[t(f.Z,{attrs:{icon:"",color:"primary"},on:{click:function(t){return e.removeDomain(r)}}},[t(w.Z,{attrs:{color:"primary"}},[e._v("mdi-delete")])],1)],1)],1)})),t(i.Z,{staticClass:"pl-3 mt-2"},[t(f.Z,{attrs:{text:"",small:"",left:"",outlined:"",color:"primary"},on:{click:e.addInput}},[t(w.Z,{attrs:{small:"",color:"primary"}},[e._v("mdi-plus-circle-outline")]),e._v(" Add domain ")],1)],1),e.errorMessage?t(K.Z,{staticClass:"mt-3",attrs:{text:"",type:"error"}},[e._v(" "+e._s(e.errorMessage)+" ")]):e._e()],2),t(h.h7,[t(T.Z),t(f.Z,{attrs:{color:"primary darken-1",text:""},on:{click:function(t){return t.preventDefault(),e.closeModal.apply(null,arguments)}}},[e._v(" Cancel ")]),t(f.Z,{attrs:{depressed:"",color:"primary",disabled:0===e.form.name.length},on:{click:function(t){return t.preventDefault(),e.onSave.apply(null,arguments)}}},[e._v(" Save ")])],1)],1)],1)],1)},X=[],Q={domain:"",isTopDomain:!1};const ee={name:"OrganizationModal",props:{addDomain:{type:Function,required:!0},deleteDomain:{type:Function,required:!0},addOrganization:{type:Function,required:!0},isOpen:{type:Boolean,required:!1,default:!1},organization:{type:String,required:!1},domains:{type:Array,required:!1,default:function(){return[]}}},data:function(){return{form:{name:"",domains:[Q]},errorMessage:"",savedData:{name:void 0,domains:[]}}},methods:{removeDomain:function(e){this.form.domains.splice(e,1)},onSave:function(){var e=this;return(0,c.Z)((0,u.Z)().mark((function t(){var n;return(0,u.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.savedData.name){t.next=22;break}return t.prev=1,t.next=4,e.addOrganization(e.form.name);case 4:if(n=t.sent,!n||n.error){t.next=15;break}if(e.savedData.name=e.form.name,e.$logger.debug("Added organization ".concat(e.form.name)),0!==e.form.domains.length||0!==e.savedData.domains.length){t.next=14;break}return e.closeModal(),e.$emit("updateOrganizations"),t.abrupt("return");case 14:e.handleDomains();case 15:t.next=20;break;case 17:t.prev=17,t.t0=t["catch"](1),e.errorMessage=e.$getErrorMessage(t.t0);case 20:t.next=23;break;case 22:e.handleDomains();case 23:case"end":return t.stop()}}),t,null,[[1,17]])})))()},closeModal:function(){this.errorMessage="",this.$emit("update:isOpen",!1)},handleDomains:function(){var e=this;return(0,c.Z)((0,u.Z)().mark((function t(){var n,a,r,i;return(0,u.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.form.domains.filter((function(t){return t.domain.length>0&&!e.savedData.domains.some((function(e){return e.domain===t.domain}))})),a=e.savedData.domains.filter((function(t){return t.domain.length>0&&!e.form.domains.some((function(e){return e.domain===t.domain}))})),t.prev=2,t.next=5,Promise.all(n.map((function(t){return e.addOrganizationDomain(t,e.form.name)})));case 5:return r=t.sent,t.next=8,Promise.all(a.map((function(t){return e.deleteOrganizationDomain(t)})));case 8:i=t.sent,(r||i)&&(e.closeModal(),e.$emit("updateOrganizations")),t.next=16;break;case 12:t.prev=12,t.t0=t["catch"](2),e.errorMessage=e.$getErrorMessage(t.t0),e.$logger.error("Error updating domains: ".concat(t.t0),{organization:e.form.name,newDomains:n,deletedDomains:a});case 16:case"end":return t.stop()}}),t,null,[[2,12]])})))()},addOrganizationDomain:function(e,t){var n=this;return(0,c.Z)((0,u.Z)().mark((function a(){var r;return(0,u.Z)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,n.addDomain(e.domain,e.isTopDomain,t);case 2:if(r=a.sent,!r||r.error){a.next=9;break}return n.savedData.domains.push(e),n.$logger.debug("Added domain",{domain:e,organization:t}),a.abrupt("return",r);case 9:r.errors&&n.$logger.error("Error adding domain: ".concat(r.errors[0].message),{domain:e,organization:t});case 10:case"end":return a.stop()}}),a)})))()},deleteOrganizationDomain:function(e){var t=this;return(0,c.Z)((0,u.Z)().mark((function n(){var a;return(0,u.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.deleteDomain(e.domain);case 2:if(a=n.sent,!a){n.next=6;break}return t.$logger.debug("Deleted domain ".concat(e.domain)),n.abrupt("return",a);case 6:case"end":return n.stop()}}),n)})))()},addInput:function(){this.form.domains.push((0,d.Z)({},Q))}},watch:{isOpen:function(e){e?(Object.assign(this.savedData,{name:this.organization,domains:this.domains.map((function(e){return(0,d.Z)({},e)}))}),Object.assign(this.form,{name:this.organization||"",domains:this.domains.map((function(e){return(0,d.Z)({},e)}))})):(Object.assign(this.form,{name:"",domains:[(0,d.Z)({},Q)]}),Object.assign(this.savedData,{name:void 0,domains:[(0,d.Z)({},Q)]}))}}},te=ee;var ne=(0,W.Z)(te,Y,X,!1,null,null,null);const ae=ne.exports;var re=n(7598);const ie={name:"OrganizationsTable",components:{DateInput:O.Z,OrganizationEntry:V,ExpandedOrganization:B,OrganizationModal:ae,Search:re.Z},props:{name:{type:String,required:!1,default:"Organizations"},isGroup:{type:Boolean,required:!1,default:!1},enroll:{type:Function,required:!0},fetchPage:{type:Function,required:!0},fetchTeams:{type:Function,required:!0},addOrganization:{type:Function,required:!0},deleteOrganization:{type:Function,required:!0},addTeam:{type:Function,required:!0},deleteTeam:{type:Function,required:!0},addDomain:{type:Function,required:!1},deleteDomain:{type:Function,required:!1},mergeItems:{type:Function,required:!1}},data:function(){return{headers:[{value:"name"},{value:"enrollments"},{value:"actions"}],expandedItems:[],items:[],pageCount:0,page:0,dialog:{open:!1,title:"",text:"",action:"",showDates:!1,dateFrom:null,dateTo:null},modal:{open:!1,organization:void 0,domains:[]},selectedOrganization:"",filters:{},totalResults:0,itemsPerPage:10,forms:{teamName:""},loading:!1}},created:function(){this.getTableItems(1)},methods:{getTableItems:function(){var e=arguments,t=this;return(0,c.Z)((0,u.Z)().mark((function n(){var a,r,i;return(0,u.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=e.length>0&&void 0!==e[0]?e[0]:t.page,r=e.length>1&&void 0!==e[1]?e[1]:t.filters,t.loading=!0,n.next=5,t.fetchPage(a,t.itemsPerPage,r);case 5:i=n.sent,i&&(t.items=i.entities,t.pageCount=i.pageInfo.numPages,t.page=i.pageInfo.page,t.totalResults=i.pageInfo.totalResults),t.loading=!1;case 8:case"end":return n.stop()}}),n)})))()},confirmEnroll:function(e){var t=this;Object.assign(this.dialog,{open:!0,title:"Affiliate the selected individuals?",text:"Individuals will be enrolled in ".concat(e.group),showDates:!0,action:function(){return t.enrollIndividuals(e.individuals,e.group,t.dialog.dateFrom,t.dialog.dateTo,e.parentOrg)}})},enrollIndividuals:function(e,t,n,a,r){var i=this;return(0,c.Z)((0,u.Z)().mark((function o(){var s,l,c,d;return(0,u.Z)().wrap((function(o){while(1)switch(o.prev=o.next){case 0:return i.closeDialog(),o.prev=1,o.next=4,Promise.all(e.map((function(e){return i.enroll(e.uuid,t,n,a,r)})));case 4:if(s=o.sent,s.forEach((function(e){i.$emit("updateWorkspace",{update:(0,$.hR)([e.data.enroll.individual])})})),i.$logger.debug("Enrolled individuals",{group:t,individuals:e,dateFrom:n,dateTo:a,parentOrg:r}),!r){o.next=17;break}if(l=e.filter((function(e){return!e.enrollments.some((function(e){return e.group.name===r}))})),!(l.length>0)){o.next=15;break}return o.next=12,Promise.all(l.map((function(e){return i.enroll(e.uuid,r,n,a)})));case 12:c=o.sent,c.forEach((function(e){i.$emit("updateWorkspace",{update:(0,$.hR)([e.data.enroll.individual])})})),i.$logger.debug("Enrolled individuals",{group:r,uuids:l,dateFrom:n,dateTo:a});case 15:d=i.expandedItems.find((function(e){return e.name===r})),i.$refs[d.id].reloadTeams();case 17:i.getTableItems(i.page),i.$emit("updateIndividuals"),o.next=25;break;case 21:o.prev=21,o.t0=o["catch"](1),Object.assign(i.dialog,{open:!0,title:"Error",text:i.$getErrorMessage(o.t0),action:null}),i.$logger.error("Error enrolling individuals: ".concat(o.t0),{group:t,individuals:e,dateFrom:n,dateTo:a,parentOrg:r});case 25:case"end":return o.stop()}}),o,null,[[1,21]])})))()},openModal:function(e){var t=e.domains&&e.domains.length>0?e.domains.map((function(e){return e})):[{domain:"",isTopDomain:!1}];Object.assign(this.modal,{open:!0,organization:e?e.name:"",domains:t})},confirmDelete:function(e){var t=this;Object.assign(this.dialog,{open:!0,title:"Delete ".concat(e,"?"),text:"",action:function(){return t.deleteGroup(e)}})},deleteGroup:function(e){var t=this;return(0,c.Z)((0,u.Z)().mark((function n(){var a;return(0,u.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.closeDialog(),n.prev=1,n.next=4,t.deleteOrganization(e);case 4:a=n.sent,a&&(t.getTableItems(t.page),t.$emit("updateIndividuals"),t.$logger.debug("Deleted ".concat(e))),n.next=12;break;case 8:n.prev=8,n.t0=n["catch"](1),Object.assign(t.dialog,{open:!0,title:"Error",text:t.$getErrorMessage(n.t0),action:null}),t.$logger.error("Error deleting ".concat(e,": ").concat(n.t0));case 12:case"end":return n.stop()}}),n,null,[[1,8]])})))()},startDrag:function(e,t){this.selectedOrganization=e.name,t.dataTransfer.dropEffect="move",t.dataTransfer.setData("type","enrollFromOrganization"),t.dataTransfer.setData("group",e.name)},filterSearch:function(e){this.filters=e,this.getTableItems(1)},changeItemsPerPage:function(e){e&&(this.itemsPerPage=parseInt(e,10),this.getTableItems(1))},closeDialog:function(){Object.assign(this.dialog,{open:!1,title:"",text:"",action:"",showDates:!1,dateFrom:null,dateTo:null})},addUnaffiliatedTeam:function(){var e=this;return(0,c.Z)((0,u.Z)().mark((function t(){var n;return(0,u.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.addTeam(e.forms.teamName);case 3:n=t.sent,n&&(e.getTableItems(),e.$logger.debug("Added team ".concat(e.forms.teamName)),e.forms.teamName=""),t.next=11;break;case 7:t.prev=7,t.t0=t["catch"](0),Object.assign(e.dialog,{open:!0,title:"Error",text:e.$getErrorMessage(t.t0),action:null}),e.$logger.error("Error adding team ".concat(e.forms.teamName,": ").concat(t.t0));case 11:case"end":return t.stop()}}),t,null,[[0,7]])})))()},getEnrolledIndividuals:function(e){if(!e)return 0;var t=new Set(e.map((function(e){return e.id})));return t.size},createTeam:function(e,t){var n=this;return(0,c.Z)((0,u.Z)().mark((function a(){var r,i;return(0,u.Z)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,n.addTeam(t,e);case 3:r=a.sent,r.errors||(i=n.expandedItems.find((function(t){return t.name===e})),i&&n.$refs[i.id].reloadTeams()),a.next=11;break;case 7:a.prev=7,a.t0=a["catch"](0),Object.assign(n.dialog,{isOpen:!0,title:"Error",text:n.$getErrorMessage(a.t0),action:null}),n.$logger.error("Error creating team: ".concat(a.t0));case 11:case"end":return a.stop()}}),a,null,[[0,7]])})))()},confirmMerge:function(e){var t=this,n=e.fromOrg,a=e.toOrg;Object.assign(this.dialog,{open:!0,title:"Merge ".concat(n," with ").concat(a,"?"),text:"".concat(n," will be deleted."),action:function(){return t.merge(n,a)}})},merge:function(e,t){var n=this;return(0,c.Z)((0,u.Z)().mark((function a(){var r;return(0,u.Z)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,n.mergeItems(e,t);case 3:r=a.sent,r.errors||(n.getTableItems(),n.closeDialog(),n.$logger.debug("Merged organization ".concat(e," with ").concat(t))),a.next=11;break;case 7:a.prev=7,a.t0=a["catch"](0),Object.assign(n.dialog,{open:!0,title:"Error",text:n.$getErrorMessage(a.t0),action:null}),n.$logger.error("Error merging ".concat(e," with ").concat(t,": ").concat(a.t0));case 11:case"end":return a.stop()}}),a,null,[[0,7]])})))()}}},oe=ie;var se=(0,W.Z)(oe,y,D,!1,null,"a48244e8",null);const le=se.exports;var ue=n(1544),ce=function(){var e=this,t=e._self._c;return t(ue.Z,{staticClass:"section",class:{"is-dragging":e.isDragging},attrs:{"data-cy":"workspace"},on:{dragover:function(t){return t.preventDefault(),e.onDrag(t)},dragenter:function(t){return t.preventDefault(),e.onDrag(t)},dragleave:function(t){t.preventDefault(),e.isDragging=!1}},nativeOn:{drop:function(t){return e.onDrop(t)}}},[t(i.Z,{staticClass:"header"},[t("h3",{staticClass:"title"},[t(w.Z,{attrs:{color:"black",dense:"",left:""}},[e._v(" mdi-pin ")]),e._v(" Workspace ")],1),t("div",[t(N.Z,{attrs:{bottom:"",transition:"expand-y-transition","open-delay":"200"},scopedSlots:e._u([{key:"activator",fn:function(n){var a=n.on;return[t(f.Z,e._g({staticClass:"mr-2",attrs:{text:"",small:"",outlined:"",disabled:e.isDisabled},on:{click:function(t){return e.mergeSelected(e.selectedIndividuals)}}},a),[t(w.Z,{attrs:{small:"",left:""}},[e._v("mdi-call-merge")]),e._v(" Merge ")],1)]}}])},[t("span",[e._v("Merge selected")])]),t(N.Z,{attrs:{bottom:"",transition:"expand-y-transition","open-delay":"200"},scopedSlots:e._u([{key:"activator",fn:function(n){var a=n.on;return[t(f.Z,e._g({attrs:{text:"",small:"",outlined:"",disabled:0===e.savedIndividuals.length},on:{click:e.clearSpace}},a),[t(w.Z,{attrs:{small:"",left:""}},[e._v("mdi-cancel")]),e._v(" Clear ")],1)]}}])},[t("span",[e._v("Clear space")])])],1)]),e.savedIndividuals.length>=1?t(i.Z,{staticClass:"space rounded pa-md-2 ma-md-3 drag-zone",attrs:{dense:""}},e._l(e.savedIndividuals,(function(n){return t(a.Z,{key:n.id,attrs:{cols:"2"}},[t("individual-card",{attrs:{name:n.name,email:n.email,sources:n.sources,"is-selected":n.isSelected,uuid:n.uuid,identities:n.identities,enrollments:n.enrollments,"is-highlighted":n.uuid===e.highlightIndividual,"is-locked":n.isLocked,closable:"",selectable:""},on:{enroll:function(t){return e.confirmEnroll(n,t)},merge:function(t){return e.mergeSelected(t)},mouseenter:function(t){return e.$emit("highlight",n)},mouseleave:function(t){return e.$emit("stopHighlight",n)},move:function(t){return e.move(t)},remove:function(t){return e.removeIndividual(n)},select:function(t){return e.selectIndividual(n)}}})],1)})),1):t(i.Z,{staticClass:"space pa-md-2 ma-md-3 align-center justify-center drag-zone",attrs:{dense:""}},[t(w.Z,{attrs:{color:"rgba(0,0,0,0.38)",left:""}},[e._v(" mdi-lightbulb-on-outline ")]),t("p",{staticClass:"mb-0 ml-2 text--disabled"},[t("span",[e._v(" You can add individuals to your work space to perform actions on them later. ")]),t("span",[e._v(" For example, to merge individuals from different searches. ")])])],1),t(k.Z,{attrs:{"max-width":"500px"},model:{value:e.dialog.open,callback:function(t){e.$set(e.dialog,"open",t)},expression:"dialog.open"}},[t(v.Z,{staticClass:"pa-3"},[t(h.EB,{staticClass:"headline"},[e._v(e._s(e.dialog.title))]),t(h.ZB,[e.dialog.text?t("p",{staticClass:"pt-2 pb-2 text-body-2"},[e._v(" "+e._s(e.dialog.text)+" ")]):e._e()]),e.dialog.action?t(h.h7,[t(T.Z),t(f.Z,{attrs:{text:""},on:{click:e.closeDialog}},[e._v(" Cancel ")]),t(f.Z,{attrs:{color:"primary",depressed:""},on:{click:function(t){return t.stopPropagation(),e.dialog.action.apply(null,arguments)}}},[e._v(" Confirm ")])],1):t(h.h7,[t(T.Z),t(f.Z,{attrs:{text:"",color:"primary"},on:{click:e.closeDialog}},[e._v(" OK ")])],1)],1)],1),t("enroll-modal",{attrs:{"is-open":e.enrollmentModal.open,title:e.enrollmentModal.title,text:e.enrollmentModal.text,organization:e.enrollmentModal.organization,uuid:e.enrollmentModal.uuid,enroll:e.enrollIndividual},on:{"update:isOpen":function(t){return e.$set(e.enrollmentModal,"open",t)},"update:is-open":function(t){return e.$set(e.enrollmentModal,"open",t)}}}),e.teamModal.isOpen?t("team-enroll-modal",{attrs:{"is-open":e.teamModal.isOpen,organization:e.teamModal.organization,team:e.teamModal.team,uuid:e.teamModal.uuid,enrollments:e.teamModal.enrollments,enroll:e.enrollIndividual},on:{"update:isOpen":function(t){return e.$set(e.teamModal,"isOpen",t)},"update:is-open":function(t){return e.$set(e.teamModal,"isOpen",t)}}}):e._e()],1)},de=[],me=n(5916),pe=n(5102),ge=n(2046),fe=n(2714),ve=n(4770);const he={name:"WorkSpace",components:{IndividualCard:ge.Z,EnrollModal:fe.Z,TeamEnrollModal:ve.Z},mixins:[pe.f],props:{highlightIndividual:{type:String,required:!1},individuals:{type:Array,required:!0},mergeItems:{type:Function,required:!0},moveItem:{type:Function,required:!0},enroll:{type:Function,required:!0}},data:function(){return{savedIndividuals:this.individuals,isDragging:!1,dialog:{open:!1,title:"",text:"",action:""}}},computed:{selectedIndividuals:function(){return this.savedIndividuals.filter((function(e){return e.isSelected}))},isDisabled:function(){return this.selectedIndividuals.filter((function(e){return!e.isLocked})).length<2}},methods:{clearSpace:function(){this.savedIndividuals=[],this.$emit("clearSpace")},onDrop:function(e){var t,n=this,a=e.dataTransfer.getData("type"),r=e.dataTransfer.types;if("move"!==a&&!r.includes("group")){var i=JSON.parse(e.dataTransfer.getData("individuals")),o=i.filter((function(e){return!n.savedIndividuals.some((function(t){return t.id===e.id}))})).map((function(e){return Object.assign(e,{isSelected:!1})}));(t=this.savedIndividuals).push.apply(t,(0,me.Z)(o)),this.isDragging=!1,this.$emit("deselect")}},merge:function(e,t){var n=this;return(0,c.Z)((0,u.Z)().mark((function a(){var r;return(0,u.Z)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,n.mergeItems(e,t);case 2:r=a.sent,r&&(n.savedIndividuals=n.updateMergedIndividuals(r.data.merge,e),n.$emit("updateIndividuals"),n.$emit("updateWorkspace",{update:n.savedIndividuals,remove:e}),n.$logger.debug("Merged individuals",{fromUuids:e,toUuid:t})),n.dialog.open=!1;case 5:case"end":return a.stop()}}),a)})))()},mergeSelected:function(e){e=e.filter((function(e){return!e.isLocked})),(0,$._Z)(e,this.merge,this.dialog)},updateMergedIndividuals:function(e,t){var n=(0,$.hR)([e.individual])[0],a=this.savedIndividuals.findIndex((function(e){return e.id===n.id}));Object.assign(this.savedIndividuals[a],n);var r=this.savedIndividuals.filter((function(e){return!t.includes(e.uuid)}));return r},selectIndividual:function(e){e.isSelected=!e.isSelected},removeIndividual:function(e){this.savedIndividuals=this.savedIndividuals.filter((function(t){return t.uuid!==e.uuid})),this.$emit("updateWorkspace",{remove:[e.uuid]}),this.$emit("stopHighlight",e)},move:function(e){(0,$.HC)(e.fromUuid,e.toUuid,this.moveAction,this.dialog)},moveAction:function(e,t){var n=this;return(0,c.Z)((0,u.Z)().mark((function a(){var r;return(0,u.Z)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n.dialog.open=!1,a.prev=1,a.next=4,n.moveItem(e,t);case 4:r=a.sent,r&&(n.savedIndividuals=n.updateMergedIndividuals(r.data.moveIdentity,[e]),n.$emit("updateIndividuals"),n.$logger.debug("Moved identity",{fromUuid:e,toUuid:t})),a.next=12;break;case 8:a.prev=8,a.t0=a["catch"](1),Object.assign(n.dialog,{open:!0,title:"Error",text:n.$getErrorMessage(a.t0),action:null}),n.$logger.error("Error moving identity: ${error}",{fromUuid:e,toUuid:t});case 12:case"end":return a.stop()}}),a,null,[[1,8]])})))()},onDrag:function(e){var t=e.dataTransfer.getData("type"),n=e.dataTransfer.types;"move"===t||n.includes("group")||(this.isDragging=!0)},closeDialog:function(){Object.assign(this.dialog,{open:!1,title:"",text:"",action:""})}},watch:{individuals:function(e){this.savedIndividuals=e},savedIndividuals:function(e){e&&this.$emit("updateStore",e)}}},Ze=he;var xe=(0,W.Z)(Ze,ce,de,!1,null,"4a31a5c4",null);const ke=xe.exports;var be=n(629);const we={name:"Dashboard",components:{IndividualsTable:g.Z,OrganizationsTable:le,WorkSpace:ke},data:function(){return{filters:null,highlightInTable:void 0,highlightInWorkspace:void 0,savedIndividuals:[],snackbar:!1}},computed:(0,d.Z)({},(0,be.Se)(["workspace"])),methods:(0,d.Z)((0,d.Z)({},(0,be.nv)(["saveWorkspace","emptyWorkspace"])),{},{getIndividualsPage:function(e,t,n,a){var r=this;return(0,c.Z)((0,u.Z)().mark((function i(){var o;return(0,u.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,(0,m.up)(r.$apollo,e,t,n,a);case 2:return o=i.sent,i.abrupt("return",o);case 4:case"end":return i.stop()}}),i)})))()},getOrganizationsPage:function(e,t,n){var a=this;return(0,c.Z)((0,u.Z)().mark((function r(){var i;return(0,u.Z)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,(0,m.xV)(a.$apollo,e,t,n);case 2:return i=r.sent,r.abrupt("return",i.data.organizations);case 4:case"end":return r.stop()}}),r)})))()},fetchTeams:function(e){var t=this;return(0,c.Z)((0,u.Z)().mark((function n(){var a;return(0,u.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,(0,m.LK)(t.$apollo,e);case 2:return a=n.sent,n.abrupt("return",a);case 4:case"end":return n.stop()}}),n)})))()},addSavedIndividuals:function(e,t){var n=this;e.forEach((function(e){var a=n.savedIndividuals.find((function(t){return e.uuid===t.uuid}));if(a)if(t){var r=n.savedIndividuals.findIndex((function(t){return e.uuid===t.uuid}));Object.assign(n.savedIndividuals[r],e)}else n.snackbar=!0;else n.savedIndividuals.push(e)}))},deleteItem:function(e){var t=this;return(0,c.Z)((0,u.Z)().mark((function n(){var a;return(0,u.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,(0,p.dU)(t.$apollo,e);case 2:return a=n.sent,n.abrupt("return",a);case 4:case"end":return n.stop()}}),n)})))()},mergeItems:function(e,t){var n=this;return(0,c.Z)((0,u.Z)().mark((function a(){var r;return(0,u.Z)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,(0,p.TS)(n.$apollo,e,t);case 2:return r=a.sent,a.abrupt("return",r);case 4:case"end":return a.stop()}}),a)})))()},updateOrganizations:function(){this.$refs.organizations.getTableItems();var e=this.$refs.organizations.$refs;Object.keys(e).forEach((function(t){return e[t].reloadTeams()}))},updateTable:function(){this.$refs.table.queryIndividuals()},updateWorkspace:function(e){var t=this;e.remove&&e.remove.forEach((function(e){var n=t.savedIndividuals.findIndex((function(t){return t.uuid==e}));-1!==n&&t.savedIndividuals.splice(n,1)})),e.update&&e.update.forEach((function(e){var n=t.savedIndividuals.findIndex((function(t){return t.uuid==e.uuid}));-1!==n&&Object.assign(t.savedIndividuals[n],e)}))},highlightIndividual:function(e,t,n){this[t]=n?e.uuid:void 0},unmergeItems:function(e){var t=this;return(0,c.Z)((0,u.Z)().mark((function n(){var a;return(0,u.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,(0,p.F7)(t.$apollo,e);case 2:return a=n.sent,n.abrupt("return",a);case 4:case"end":return n.stop()}}),n)})))()},moveItem:function(e,t){var n=this;return(0,c.Z)((0,u.Z)().mark((function a(){var r;return(0,u.Z)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,(0,p.HC)(n.$apollo,e,t);case 2:return r=a.sent,a.abrupt("return",r);case 4:case"end":return a.stop()}}),a)})))()},deselectIndividuals:function(){this.$refs.table.deselectIndividuals()},enroll:function(e,t,n,a,r){var i=this;return(0,c.Z)((0,u.Z)().mark((function o(){var s;return(0,u.Z)().wrap((function(o){while(1)switch(o.prev=o.next){case 0:return o.next=2,(0,p.jb)(i.$apollo,e,t,n,a,r);case 2:return s=o.sent,o.abrupt("return",s);case 4:case"end":return o.stop()}}),o)})))()},addIdentity:function(e,t,n,a){var r=this;return(0,c.Z)((0,u.Z)().mark((function i(){var o;return(0,u.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,(0,p.bg)(r.$apollo,e,t,n,a);case 2:return o=i.sent,i.abrupt("return",o);case 4:case"end":return i.stop()}}),i)})))()},updateProfile:function(e,t){var n=this;return(0,c.Z)((0,u.Z)().mark((function a(){var r;return(0,u.Z)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=(0,p.ck)(n.$apollo,e,t),a.abrupt("return",r);case 2:case"end":return a.stop()}}),a)})))()},addOrganization:function(e){var t=this;return(0,c.Z)((0,u.Z)().mark((function n(){var a;return(0,u.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,(0,p.Fi)(t.$apollo,e);case 2:return a=n.sent,n.abrupt("return",a);case 4:case"end":return n.stop()}}),n)})))()},deleteOrganization:function(e){var t=this;return(0,c.Z)((0,u.Z)().mark((function n(){var a;return(0,u.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,(0,p.Mz)(t.$apollo,e);case 2:return a=n.sent,n.abrupt("return",a);case 4:case"end":return n.stop()}}),n)})))()},addTeam:function(e,t,n){var a=this;return(0,c.Z)((0,u.Z)().mark((function r(){var i;return(0,u.Z)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,(0,p.fg)(a.$apollo,e,t,n);case 2:return i=r.sent,r.abrupt("return",i);case 4:case"end":return r.stop()}}),r)})))()},deleteTeam:function(e,t){var n=this;return(0,c.Z)((0,u.Z)().mark((function a(){var r;return(0,u.Z)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,(0,p.fC)(n.$apollo,e,t);case 2:return r=a.sent,a.abrupt("return",r);case 4:case"end":return a.stop()}}),a)})))()},addDomain:function(e,t,n){var a=this;return(0,c.Z)((0,u.Z)().mark((function r(){var i;return(0,u.Z)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,(0,p.jc)(a.$apollo,e,t,n);case 2:return i=r.sent,r.abrupt("return",i);case 4:case"end":return r.stop()}}),r)})))()},deleteDomain:function(e){var t=this;return(0,c.Z)((0,u.Z)().mark((function n(){var a;return(0,u.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,(0,p.dj)(t.$apollo,e);case 2:return a=n.sent,n.abrupt("return",a);case 4:case"end":return n.stop()}}),n)})))()},getCountries:function(){var e=this;return(0,c.Z)((0,u.Z)().mark((function t(){var n;return(0,u.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,(0,m.ox)(e.$apollo);case 2:return n=t.sent,t.abrupt("return",n.data.countries.entities);case 4:case"end":return t.stop()}}),t)})))()},lockIndividual:function(e){var t=this;return(0,c.Z)((0,u.Z)().mark((function n(){var a;return(0,u.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,(0,p.H_)(t.$apollo,e);case 2:return a=n.sent,n.abrupt("return",a);case 4:case"end":return n.stop()}}),n)})))()},unlockIndividual:function(e){var t=this;return(0,c.Z)((0,u.Z)().mark((function n(){var a;return(0,u.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,(0,p.Yd)(t.$apollo,e);case 2:return a=n.sent,n.abrupt("return",a);case 4:case"end":return n.stop()}}),n)})))()},withdraw:function(e,t,n,a,r){var i=this;return(0,c.Z)((0,u.Z)().mark((function o(){var s;return(0,u.Z)().wrap((function(o){while(1)switch(o.prev=o.next){case 0:return o.next=2,(0,p.XW)(i.$apollo,e,t,n,a,r);case 2:return s=o.sent,o.abrupt("return",s);case 4:case"end":return o.stop()}}),o)})))()},updateEnrollment:function(e){var t=this;return(0,c.Z)((0,u.Z)().mark((function n(){var a;return(0,u.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,(0,p.Ku)(t.$apollo,e);case 2:return a=n.sent,n.abrupt("return",a);case 4:case"end":return n.stop()}}),n)})))()},clearWorkspace:function(){this.emptyWorkspace(),this.savedIndividuals=[]},getEnrollments:function(e){var t=this,n=e.enrollment,a=e.parentOrg,r='enrollment:"'.concat(n,'"');a&&(r=r.concat(' enrollmentParentOrg:"'.concat(a,'"'))),this.filters===r&&this.$refs.table.queryIndividuals(),this.$nextTick((function(){return t.filters=r}))},getRecommendations:function(e,t){var n=this;return(0,c.Z)((0,u.Z)().mark((function a(){var r;return(0,u.Z)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,(0,m.Dt)(n.$apollo,e,t);case 2:return r=a.sent,a.abrupt("return",r);case 4:case"end":return a.stop()}}),a)})))()},getRecommendationsCount:function(){var e=this;return(0,c.Z)((0,u.Z)().mark((function t(){var n;return(0,u.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,(0,m.vt)(e.$apollo);case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}}),t)})))()},manageRecommendation:function(e,t){var n=this;return(0,c.Z)((0,u.Z)().mark((function a(){var r;return(0,u.Z)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,(0,p.HD)(n.$apollo,e,t);case 2:return r=a.sent,a.abrupt("return",r);case 4:case"end":return a.stop()}}),a)})))()},recommendMatches:function(e,t,n){var a=this;return(0,c.Z)((0,u.Z)().mark((function r(){var i;return(0,u.Z)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,(0,p.GY)(a.$apollo,e,t,n);case 2:return i=r.sent,r.abrupt("return",i);case 4:case"end":return r.stop()}}),r)})))()},mergeOrgs:function(e,t){var n=this;return(0,c.Z)((0,u.Z)().mark((function a(){var r;return(0,u.Z)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,(0,p.jt)(n.$apollo,e,t);case 2:return r=a.sent,a.abrupt("return",r);case 4:case"end":return a.stop()}}),a)})))()}}),mounted:function(){var e=this;return(0,c.Z)((0,u.Z)().mark((function t(){var n,a;return(0,u.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(e.workspace&&e.workspace.length>0)){t.next=6;break}return t.next=3,Promise.all(e.workspace.map((function(t){return(0,m.kA)(e.$apollo,t)})));case 3:n=t.sent,a=n.map((function(e){return e.data.individuals.entities[0]})),e.savedIndividuals=(0,$.hR)(a);case 6:case"end":return t.stop()}}),t)})))()},provide:function(){return{getRecommendations:this.getRecommendations,getRecommendationsCount:this.getRecommendationsCount,manageRecommendation:this.manageRecommendation}}},Ie=we;var Te=(0,W.Z)(Ie,s,l,!1,null,"0e3cdd8a",null);const _e=Te.exports},4590:(e,t,n)=>{n.d(t,{Z:()=>m});var a=n(4503),r=(n(9653),n(6699),n(2564),n(1544)),i=n(8914),o=n(3276),s=n(6470),l=n(8386),u=n(4987),c=n(1050),d=n(6596);const m=(0,u.Z)(r.Z,i.Z,s.Z,(0,l.d)(["absolute","bottom","left","right","top"])).extend({name:"v-snackbar",props:{app:Boolean,centered:Boolean,contentClass:{type:String,default:""},multiLine:Boolean,text:Boolean,timeout:{type:[Number,String],default:5e3},transition:{type:[Boolean,String],default:"v-snack-transition",validator:function(e){return"string"===typeof e||!1===e}},vertical:Boolean},data:function(){return{activeTimeout:-1}},computed:{classes:function(){return{"v-snack--absolute":this.absolute,"v-snack--active":this.isActive,"v-snack--bottom":this.bottom||!this.top,"v-snack--centered":this.centered,"v-snack--has-background":this.hasBackground,"v-snack--left":this.left,"v-snack--multi-line":this.multiLine&&!this.vertical,"v-snack--right":this.right,"v-snack--text":this.text,"v-snack--top":this.top,"v-snack--vertical":this.vertical}},hasBackground:function(){return!this.text&&!this.outlined},isDark:function(){return this.hasBackground?!this.light:o.Z.options.computed.isDark.call(this)},styles:function(){if(this.absolute||!this.app)return{};var e=this.$vuetify.application,t=e.bar,n=e.bottom,a=e.footer,r=e.insetFooter,i=e.left,o=e.right,s=e.top;return{paddingBottom:(0,c.kb)(n+a+r),paddingLeft:(0,c.kb)(i),paddingRight:(0,c.kb)(o),paddingTop:(0,c.kb)(t+s)}}},watch:{isActive:"setTimeout",timeout:"setTimeout"},mounted:function(){this.isActive&&this.setTimeout()},created:function(){this.$attrs.hasOwnProperty("auto-height")&&(0,d.Jk)("auto-height",this),0==this.timeout&&(0,d.Rn)('timeout="0"',"-1",this)},methods:{genActions:function(){return this.$createElement("div",{staticClass:"v-snack__action "},[(0,c.z9)(this,"action",{attrs:{class:"v-snack__btn"}})])},genContent:function(){return this.$createElement("div",{staticClass:"v-snack__content",class:(0,a.Z)({},this.contentClass,!0),attrs:{role:"status","aria-live":"polite"}},[(0,c.z9)(this)])},genWrapper:function(){var e=this,t=this.hasBackground?this.setBackgroundColor:this.setTextColor,n=t(this.color,{staticClass:"v-snack__wrapper",class:r.Z.options.computed.classes.call(this),style:r.Z.options.computed.styles.call(this),directives:[{name:"show",value:this.isActive}],on:{pointerenter:function(){return window.clearTimeout(e.activeTimeout)},pointerleave:this.setTimeout}});return this.$createElement("div",n,[this.genContent(),this.genActions()])},genTransition:function(){return this.$createElement("transition",{props:{name:this.transition}},[this.genWrapper()])},setTimeout:function(){var e=this;window.clearTimeout(this.activeTimeout);var t=Number(this.timeout);this.isActive&&![0,-1].includes(t)&&(this.activeTimeout=window.setTimeout((function(){e.isActive=!1}),t))}},render:function(e){return e("div",{staticClass:"v-snack",class:this.classes,style:this.styles},[!1!==this.transition?this.genTransition():this.genWrapper()])}})}}]);