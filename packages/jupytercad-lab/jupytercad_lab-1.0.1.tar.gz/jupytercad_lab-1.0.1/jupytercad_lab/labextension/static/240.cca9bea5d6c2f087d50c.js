"use strict";(self.webpackChunk_jupytercad_jupytercad_lab=self.webpackChunk_jupytercad_jupytercad_lab||[]).push([[240],{240:(e,t,a)=>{a.r(t),a.d(t,{default:()=>j});var o=a(748),r=a(352),n=a(812),d=a(804),s=a(216),i=a(208),l=a(440),c=a(8),u=a(460),p=a(760),g=a(776);class y extends g.JupyterYModel{}class h extends p.Panel{constructor(e){super(),this.onResize=()=>{this._jcadWidget&&u.MessageLoop.sendMessage(this._jcadWidget,p.Widget.ResizeMessage.UnknownSize)},this.addClass("jupytercad-notebook-widget"),this._jcadWidget=new o.JupyterCadPanel(e),this.addWidget(this._jcadWidget)}}const M={id:"jupytercad:yjswidget-plugin",autoStart:!0,requires:[r.IJCadWorkerRegistryToken],optional:[g.IJupyterYWidgetManager,s.ITranslator],activate:(e,t,a,o)=>{if(!a)return void console.error("Missing IJupyterYWidgetManager token!");const n=null!=o?o:s.nullTranslator;a.registerWidget("@jupytercad:widget",class extends y{ydocFactory(t){const{path:a,format:o,contentType:d}=t;this.jupyterCADModel=new r.JupyterCadModel({});const s=e.serviceManager.user;if(a&&o&&d){const e=c.ServerConnection.makeSettings(),t=l.URLExt.join(e.wsUrl,"api/collaboration/room"),r=new i.WebSocketProvider({url:t,path:a,format:o,contentType:d,model:this.jupyterCADModel.sharedModel,user:s,translator:n.load("jupyterlab")});this.jupyterCADModel.disposed.connect((()=>{r.dispose()}))}else{const e=this.jupyterCADModel.sharedModel.awareness,t=t=>{e.setLocalStateField("user",t.identity)};s.ready.then((()=>{t(s)})).catch((e=>console.error(e))),s.userChanged.connect(t,this)}return this.jupyterCADModel.sharedModel.ydoc}},class{constructor(e,a){this.yModel=e,this.node=a;const o=new h({model:e.jupyterCADModel,workerRegistry:t});u.MessageLoop.sendMessage(o,p.Widget.Msg.BeforeAttach),a.appendChild(o.node),u.MessageLoop.sendMessage(o,p.Widget.Msg.AfterAttach)}})}},C="jupytercad",j=[{id:"jupytercad:lab:main-menu",autoStart:!0,requires:[r.IJupyterCadDocTracker,r.IJCadFormSchemaRegistryToken],optional:[d.IMainMenu,s.ITranslator],activate:(e,t,a,r,n)=>{console.log("jupytercad:lab:main-menu is activated!"),n=null!=n?n:s.nullTranslator;(0,o.addCommands)(e,t,n,a),r&&function(e,t){e.editMenu.undoers.redo.add({id:o.CommandIDs.redo,isEnabled:t}),e.editMenu.undoers.undo.add({id:o.CommandIDs.undo,isEnabled:t})}(r,(()=>null!==t.currentWidget&&t.currentWidget===e.shell.currentWidget))}},{id:"jupytercad:lab:controlpanel",autoStart:!0,requires:[n.ILayoutRestorer,r.IJupyterCadDocTracker,r.IAnnotationToken,r.IJCadFormSchemaRegistryToken],activate:(e,t,a,r,n)=>{const d=new o.ControlPanelModel({tracker:a}),s=new o.LeftPanelWidget({model:d,annotationModel:r,tracker:a});s.id="jupytercad::leftControlPanel",s.title.caption="JupyterCad Control Panel",s.title.icon=o.jcLightIcon;const i=new o.RightPanelWidget({model:d,formSchemaRegistry:n});i.id="jupytercad::rightControlPanel",i.title.caption="JupyterCad Control Panel",i.title.icon=o.jcLightIcon,t&&(t.add(s,C),t.add(i,C)),e.shell.add(s,"left",{rank:2e3}),e.shell.add(i,"right",{rank:2e3})}},M]}}]);