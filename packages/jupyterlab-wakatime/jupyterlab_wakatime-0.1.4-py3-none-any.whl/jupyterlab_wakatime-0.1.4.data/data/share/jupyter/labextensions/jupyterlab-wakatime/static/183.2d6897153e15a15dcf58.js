"use strict";(self.webpackChunkjupyterlab_wakatime=self.webpackChunkjupyterlab_wakatime||[]).push([[183],{183:(e,t,n)=>{n.r(t),n.d(t,{default:()=>l});var o=n(29),a=n(75),c=n(333),r=n(601);let i=Date.now();const s=(e,t)=>{console.log(t,e);const n=Date.now();if("change"===t&&n-i<12e4)return;const o={filepath:e,timestamp:n/1e3,iswrite:"write"===t};i=n,async function(e="",t={}){const n=r.ServerConnection.makeSettings(),o=c.URLExt.join(n.baseUrl,"jupyterlab-wakatime",e);let a;try{a=await r.ServerConnection.makeRequest(o,t,n)}catch(e){throw new r.ServerConnection.NetworkError(e)}let i=await a.text();if(i.length>0)try{i=JSON.parse(i)}catch(e){console.log("Not a JSON response body.",a)}if(!a.ok)throw new r.ServerConnection.ResponseError(a,i.message||i)}("heartbeat",{body:JSON.stringify(o),method:"POST"})},l={id:"jupyterlab-wakatime:plugin",description:"A JupyterLab WakaTime extension.",autoStart:!0,requires:[o.INotebookTracker,a.IEditorTracker],activate:(e,t,n)=>{console.log("JupyterLab extension jupyterlab-wakatime is activated!"),t.widgetAdded.connect(((e,t)=>{var n,o;const a=t.sessionContext.path;null===(n=t.content.model)||void 0===n||n.contentChanged.connect((()=>{s(a,"change")})),null===(o=t.content.model)||void 0===o||o.stateChanged.connect(((e,t)=>{"dirty"===t.name&&t.oldValue&&s(a,"write")}))})),t.currentChanged.connect(((e,t)=>{null!==t&&s(t.sessionContext.path,"switch")})),n.widgetAdded.connect(((e,t)=>{t.context.fileChanged.connect((e=>{s(e.path,"change")})),t.context.saveState.connect(((e,t)=>{"completed"===t&&s(e.path,"write")}))})),n.currentChanged.connect(((e,t)=>{null!==t&&s(t.context.path,"switch")}))}}}}]);