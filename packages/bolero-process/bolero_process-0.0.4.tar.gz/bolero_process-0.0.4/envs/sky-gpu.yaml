# jupyter.yaml

resources:
  cloud: gcp
  instance_type: n1-standard-8
  region: us-central1
  disk_size: 384
  accelerators: K80:1

file_mounts:
  /data:
    source: gs://hms-hanqing-analysis
    mode: MOUNT
  /ref:
    source: gs://hms-hanqing-reference
    mode: MOUNT
  /wmb:
    source: gs://hms-hanqing-wmb
    mode: MOUNT
  /tempdata:
    source: gs://hms-hanqing-temp
    mode: MOUNT

setup: |
  if [ -f $HOME/SKIPSETUP ]
  then
    echo "Skip setup"
  else
    conda create --name d2l python=3.9 -y
    conda activate d2l
    pip install torch==2.0.0 torchvision==0.15.1
    pip install d2l==1.0.3
    pip install xarray zarr dask jupyterlab_execute_time jupyterlab-code-formatter black isort
    touch $HOME/SKIPSETUP
  fi

run: |
  pwd
